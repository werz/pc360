(function(b){var a=function(f,i){var m=b(f);var r=this;var p={imageDir:"images",imageExt:"jpg",imageCount:0,zoomPower:2,zoomRadius:100,autoRotate:false,autoRotateInterval:100,fadeInInterval:400,canvasWidth:0,canvasHeight:0,canvasID:""};var h;var z=false;var g;var e,d=1;var v=false;var D;var q=new Array();var E=0;var C=0;var w=0;var x=0;var l=0;var B=0;var n;i=b.extend(p,i);var u=function(){g.clearRect(0,0,g.canvas.width,g.canvas.height);};var t=function(){for(var F=1;F<=i.imageCount;F++){q[F]=new Image();q[F].src=i.imageDir+"/"+F+"."+i.imageExt;u();q[F].onload=function(){g.font="italic 40pt Calibri";g.fillText("loading:"+(F-1)+"/"+i.imageCount,150,100);};}};var s=function(){u();g.globalAlpha=E;image=new Image();image.onload=function(){g.drawImage(image,0,0,g.canvas.width,g.canvas.height);};image.src=i.imageDir+"/1."+i.imageExt;E=E+0.1;if(E>1){clearInterval(C);}};var y=function(){if(i.canvasWidth==0){alert("Provide a CANVAS WIDTH");}if(i.canvasHeight==0){alert("Provide a CANVAS Height");}if(i.imageCount<=0){alert("provide IMAGE COUNT ");}if(i.canvasID==""){alert("provide CANVAS ID ");}if(i.zoomPower<=0){alert("Zoom Power have a value of greater than 0");}if(i.zoomRadius<50){alert("Provide a Zoom Radius of at least 50 or more ");}if(i.imageExt==""){alert("Provide Image extension. Ex: png,jpg");}if(i.imageDir==""){alert("Provide Image Direcotry");}m.append("<canvas id='"+i.canvasID+"' width='"+i.canvasWidth+"' height='"+i.canvasHeight+"'></canvas>").css({cursor:"e-resize"});m.css({width:i.canvasWidth+"px",height:i.canvasHeight+"px",position:"relative"});h=document.getElementById(i.canvasID);g=h.getContext("2d");D=h.width/i.imageCount;m.find(".autorotate").css({position:"absolute",right:"1%",bottom:"1%",display:"block",padding:"5px"});u();t();C=setInterval(function(){s();},i.fadeInInterval);if(i.autoRotate==true&&typeof q[i.imageCount]!="undefined"){j();m.find(".autorotate").text("Stop Auto Rotate");}m.find("canvas").mousemove(function(G){var F=b(h).offset();e=Math.floor(G.pageX-F.left);d=Math.floor(G.pageY-F.top);l=Math.ceil(e/D);if(l<=0){l=1;}else{if(l>i.imageCount){l=i.imageCount;}else{}}if(i.autoRotate==false&&v==false){k(l);}if(v==true){c(q[B]);}});m.find("#"+i.canvasID).mousedown(function(G){v=true;if(i.autoRotate==true){o();}var F=b(h).offset();e=Math.floor(G.pageX-F.left);d=Math.floor(G.pageY-F.top);B=Math.ceil(e/D);if(B<=0){B=1;}else{if(B>i.imageCount){B=i.imageCount;}else{}}});m.find("#"+i.canvasID).mouseup(function(F){v=false;B=0;b(this).css({cursor:"e-resize"});});m.find(".autorotate").click(function(F){F.preventDefault();if(i.autoRotate==false){j();b(this).text("Stop Auto Rotate");}else{o();b(this).text("Auto Rotate");}});};var k=function(F){u();g.drawImage(q[F],0,0,g.canvas.width,g.canvas.height);};var j=function(){i.autoRotate=true;x=setInterval(function(){A();},i.autoRotateInterval);};function o(){i.autoRotate=false;clearInterval(x);}function A(){if(l>0&&l<=i.imageCount&&w<=0){w=l;}w++;if(w>i.imageCount){w=1;}k(w);}var c=function(F){u();if(v){g.drawImage(F,0-e*(i.zoomPower-1),0-d*(i.zoomPower-1),g.canvas.width*i.zoomPower,g.canvas.height*i.zoomPower);g.globalCompositeOperation="destination-atop";g.beginPath();g.arc(e,d,i.zoomRadius,0,Math.PI*2,true);g.closePath();g.fill();}g.drawImage(F,0,0,g.canvas.width,g.canvas.height);};y();};b.fn.tikslus360=function(c){return this.each(function(){var d=b(this);if(d.data("tikslus360")){return;}var e=new a(this,c);d.data("tikslus360",e);});};})(jQuery);